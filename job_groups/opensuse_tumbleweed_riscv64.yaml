############################################################
#                         WARNING                          #
#                                                          #
#               This file is managed in GIT!               #
#  Any changes via the openQA WebUI will get overwritten!  #
#                                                          #
#    https://github.com/os-autoinst/opensuse-jobgroups     #
#       job_groups/opensuse_tumbleweed_riscv64.yaml        #
############################################################

---

defaults:
  riscv64:
    machine: riscv64
    priority: 50
products:
  opensuse-Tumbleweed-DVD-riscv64:
    distri: opensuse
    flavor: DVD
    version: Tumbleweed
  opensuse-Tumbleweed-NET-riscv64:
    distri: opensuse
    flavor: NET
    version: Tumbleweed
  opensuse-Tumbleweed-JeOS-for-RISCV-riscv64:
    distri: opensuse
    flavor: JeOS-for-RISCV
    version: Tumbleweed
scenarios:
  riscv64:
    opensuse-Tumbleweed-DVD-riscv64:
      - textmode
      - minimalx
    opensuse-Tumbleweed-NET-riscv64:
      - create_hdd_textmode
      - extra_tests_filesystem
      - containers_image:
          testsuite: extra_tests_textmode_containers
          settings:
            CONTAINER_RUNTIMES: 'docker,podman'
            K3S_INSTALL_UPSTREAM: '1'
            CONTAINERS_UNTESTED_IMAGES: '1'
            CONTAINER_IMAGE_TO_TEST: registry.opensuse.org/opensuse/factory/riscv/totest/containers/opensuse/tumbleweed
            POSTGRES_IP: 'ko.dmz-prg2.suse.org'
            POSTGRES_PORT: '5444'
    opensuse-Tumbleweed-JeOS-for-RISCV-riscv64:
      - jeos:
          settings:
            EXCLUDE_MODULES: libzypp_config
      - jeos:
          machine: riscv64_cpu_max
          settings:
            EXCLUDE_MODULES: libzypp_config
      - jeos-container_host_podman:
          settings:
            BOOT_HDD_IMAGE: '1'
            CONTAINER_RUNTIMES: 'podman'
      - jeos-container_host_docker:
          settings:
            BOOT_HDD_IMAGE: '1'
            CONTAINER_RUNTIMES: 'docker'
            EXCLUDE_MODULES: 'rootless_docker,validate_btrfs'
      - jeos-ltp-commands:
          settings:
            EXCLUDE_MODULES: libzypp_config
            LTP_TAINT_EXPECTED: '0x13801'
      - jeos-ltp-containers:
          settings:
            EXCLUDE_MODULES: libzypp_config
      - jeos-ltp-cve:
          settings:
            EXCLUDE_MODULES: libzypp_config
      - jeos-ltp-syscalls:
          settings:
            EXCLUDE_MODULES: libzypp_config
            LTP_ENV: 'TMPDIR=/var/tmp,LTP_TIMEOUT_MUL=2,LTP_RUNTIME_MUL=2'
            LTP_TAINT_EXPECTED: '0x13801'
            # Too performance sensitive for software emulation
            LTP_COMMAND_EXCLUDE: '(epoll_wait|epoll_pwait|select|prctl09).*'
